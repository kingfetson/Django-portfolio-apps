<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="{{ portfolio.tagline|default:'Personal portfolio website' }}">
    <meta name="author" content="{{ portfolio.title|default:'Portfolio Owner' }}">

    <title>{% block title %}{{ portfolio.title|default:"My Portfolio" }}{% endblock %}</title>

    <!-- Icons -->
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
          integrity="sha512-p1Cm..."
          crossorigin="anonymous"
          referrerpolicy="no-referrer">

    <!-- Styles -->
    <link rel="stylesheet" href="{% static 'landing/css/main.css' %}">
    <link rel="stylesheet" href="{% static 'landing/css/animations.css' %}">
    <link rel="stylesheet" href="{% static 'landing/css/mobile-menu.css' %}">

    {% block extra_css %}{% endblock %}
</head>

<body>
<div class="container">

    <!-- ================= Header ================= -->
    <header>
        <a href="/" class="logo" aria-label="Homepage">
            {{ portfolio.title|default:"Portfolio" }}
        </a>

        <nav aria-label="Primary navigation">
            {% if header_menu %}
                {% for item in header_menu %}
                    <a href="{{ item.url }}"
                       {% if item.open_in_new_tab %}target="_blank" rel="noopener"{% endif %}>
                        {{ item.title }}
                    </a>
                {% endfor %}
            {% else %}
                <a href="/">Home</a>
                <a href="/projects/">Projects</a>
                <a href="/skills/">Skills</a>
                <a href="/dishes/">Dishes</a>
                <a href="/travel/">Travel</a>
                <a href="/admin/">Admin</a>
            {% endif %}
        </nav>
    </header>

    <!-- ================= Main ================= -->
    <main>

        {% block content %}

        <!-- Hero -->
        <section class="hero">
            <h1>{{ portfolio.title|default:"Welcome" }}</h1>
            <p>{{ portfolio.tagline|default:"Building amazing things with code" }}</p>

            {% if portfolio %}
                <a href="#contact" class="cta-button">Get In Touch</a>
            {% endif %}
        </section>

        <!-- About -->
        {% if portfolio.bio %}
        <section>
            <h2 class="section-title">About Me</h2>
            <div class="about-content">
                {{ portfolio.bio|linebreaks }}
            </div>
        </section>
        {% endif %}

        <!-- Projects -->
        {% if featured_projects %}
        <section>
            <h2 class="section-title">Featured Projects</h2>

            <div class="projects-grid">
                {% for project in featured_projects %}
                <article class="project-card">
                    <h3>{{ project.title }}</h3>
                    <p>{{ project.tagline }}</p>

                    {% if project.technologies.exists %}
                    <div class="project-tags">
                        {% for tech in project.technologies.all|slice:":3" %}
                            <span class="tag">{{ tech.name }}</span>
                        {% endfor %}
                        {% if project.technologies.count > 3 %}
                            <span class="tag">+{{ project.technologies.count|add:"-3" }} more</span>
                        {% endif %}
                    </div>
                    {% endif %}

                    <div class="project-links">
                        {% if project.github_url %}
                        <a href="{{ project.github_url }}" target="_blank" rel="noopener">
                            GitHub
                        </a>
                        {% endif %}
                        {% if project.live_url %}
                        <a href="{{ project.live_url }}" target="_blank" rel="noopener">
                            Live Demo
                        </a>
                        {% endif %}
                    </div>
                </article>
                {% endfor %}
            </div>
        </section>
        {% endif %}

        <!-- Skills -->
        {% if featured_skills %}
        <section>
            <h2 class="section-title">My Skills</h2>

            <div class="skills-grid">
                {% for skill in featured_skills %}
                <div class="skill-card">
                    <h3>{{ skill.name }}</h3>

                    <div class="progress-bar" aria-label="Skill proficiency">
                        <div class="progress-fill"
                             style="width: {{ skill.proficiency }}%">
                        </div>
                    </div>

                    <div class="skill-meta">
                        <span>{{ skill.proficiency }}%</span>
                        <span>{{ skill.years_of_experience|floatformat:1 }} yrs</span>
                    </div>

                    {% if skill.short_description %}
                        <p class="skill-description">{{ skill.short_description }}</p>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        </section>
        {% endif %}

        <!-- API Widgets -->
        <section class="api-widgets-container">

            {% if enable_weather_widget %}
            <div class="api-widget weather-widget">
                <h3><i class="fas fa-cloud-sun"></i> Weather</h3>
                <div id="weather-data" class="loading">Loading weather…</div>
            </div>
            {% endif %}

            {% if enable_quote_widget %}
            <div class="api-widget quote-widget">
                <h3><i class="fas fa-quote-left"></i> Quote</h3>
                <div id="quote-data" class="loading">Loading quote…</div>
            </div>
            {% endif %}

            {% if portfolio.github_username and enable_github_widget %}
            <div class="api-widget github-widget">
                <h3><i class="fab fa-github"></i> GitHub</h3>
                <div id="github-data" class="loading">Loading GitHub stats…</div>
            </div>
            {% endif %}

        </section>

        <!-- Contact -->
        <section id="contact">
            <h2 class="section-title">Get In Touch</h2>

            {% if portfolio %}
            <div class="contact-container">
                <div class="contact-info">
                    {% if portfolio.email %}
                        <p><i class="fas fa-envelope"></i> {{ portfolio.email }}</p>
                    {% endif %}
                    {% if portfolio.phone %}
                        <p><i class="fas fa-phone"></i> {{ portfolio.phone }}</p>
                    {% endif %}
                    {% if portfolio.location %}
                        <p><i class="fas fa-map-marker-alt"></i> {{ portfolio.location }}</p>
                    {% endif %}
                </div>

                <div class="social-links">
                    {% if portfolio.github %}
                        <a href="{{ portfolio.github }}" target="_blank" rel="noopener"><i class="fab fa-github"></i></a>
                    {% endif %}
                    {% if portfolio.linkedin %}
                        <a href="{{ portfolio.linkedin }}" target="_blank" rel="noopener"><i class="fab fa-linkedin"></i></a>
                    {% endif %}
                    {% if portfolio.twitter %}
                        <a href="{{ portfolio.twitter }}" target="_blank" rel="noopener"><i class="fab fa-twitter"></i></a>
                    {% endif %}
                    {% if portfolio.instagram %}
                        <a href="{{ portfolio.instagram }}" target="_blank" rel="noopener"><i class="fab fa-instagram"></i></a>
                    {% endif %}
                </div>
            </div>
            {% else %}
                <p>Set up your portfolio in the admin panel.</p>
                <a href="/admin/" class="cta-button">Go to Admin</a>
            {% endif %}
        </section>

        {% endblock %}
    </main>

    <!-- ================= Footer ================= -->
    <footer>
        <p>{{ portfolio.title|default:"Portfolio" }} © {% now "Y" %}</p>
        <p class="footer-note">Built with Django ❤️</p>
    </footer>

</div>

<!-- Scripts -->
<script src="{% static 'landing/js/main.js' %}" defer></script>

{% block extra_js %}
<script defer>
    {% if enable_weather_widget %}
        fetchWeatherData();
    {% endif %}

    {% if enable_quote_widget %}
        fetchQuoteData();
    {% endif %}

    {% if portfolio.github_username and enable_github_widget %}
        fetchGitHubData('{{ portfolio.github_username }}');
    {% endif %}
</script>
{% endblock %}

</body>
</html>
